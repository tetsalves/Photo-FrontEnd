(function(){Storage.prototype.setObject=function(b,a){this.setItem(b,JSON.stringify(a))};Storage.prototype.getObject=function(b){return(b=this.getItem(b))&&JSON.parse(b)};var e=OP.Util.constructor.prototype,d=function(b){"undefined"!==typeof console&&console.log(b)};OP.Batch=new function(){var b=this;this._callbackAdd=function(a){a=a.result;b.collection.add(a.id,a);OP.Util.fire("callback:batch-add",a)};this.add=function(a){var c={};1<arguments.length&&(c=arguments[1]);d("[Util][Batch] adding "+a);
e.makeRequest("/photo/"+a+"/view.json",c,this._callbackAdd,"json","get")};this.remove=function(a){d("[Util][Batch] removing "+a);b.collection.remove(a)};this.clear=function(){d("[Util][Batch] clearing");this.collection.clear()};this.collection=function(){var a,c;c=localStorage.getObject("items")||{};return{add:function(b,f){c[b]=f;localStorage.setObject("items",c);a++},clear:function(){c={};localStorage.setObject("items",{});a=0;OP.Util.fire("callback:batch-clear")},getAll:function(){return c},getIds:function(){var a=
[];for(i in c)a.push(i);return a},getLength:function(){var a=0,b;for(b in c)c.hasOwnProperty(b)&&a++;return a},remove:function(b){delete c[b];localStorage.setObject("items",c);a--;OP.Util.fire("callback:batch-remove",b)}}}()}})();
